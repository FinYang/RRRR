<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to RRRR • RRRR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to RRRR">
<meta property="og:description" content="RRRR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-129140417-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129140417-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RRRR</a>
        <span class="version label label-warning" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/RRRR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FinYang/RRRR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to RRRR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FinYang/RRRR/blob/HEAD/vignettes/RRRR.Rmd" class="external-link"><code>vignettes/RRRR.Rmd</code></a></small>
      <div class="hidden name"><code>RRRR.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.yangzhuoranyang.com/RRRR/" class="external-link">RRRR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The R package <em>RRRR</em> provides methods for estimating online
Robust Reduced-Rank Regression.</p>
<p>If you use any code from the <code>RRRR</code> package in a
publication, please use the following citation:</p>
<blockquote>
<p>Yangzhuoran Yang and Ziping Zhao (2020). RRRR: Online Robust
Reduced-Rank Regression Estimation. R package version 1.1.0. <a href="https://pkg.yangzhuoranyang.com/RRRR/" class="external-link uri">https://pkg.yangzhuoranyang.com/RRRR/</a>.</p>
</blockquote>
<p>This vignette aims to provide illustrations to estimate and update
(Online) Reduced-Rank Regression using various methods contained in the
package.</p>
</div>
<div class="section level2">
<h2 id="formulation">Formulation<a class="anchor" aria-label="anchor" href="#formulation"></a>
</h2>
<p>The formulation of the reduced-rank regression is as follow: <span class="math display">\[y = \mu +AB'  x + D z+innov,\]</span> where
for each realization</p>
<ul>
<li>
<span class="math inline">\(y\)</span> is a vector of dimension
<span class="math inline">\(P\)</span> for the <span class="math inline">\(P\)</span> response variables,</li>
<li>
<span class="math inline">\(x\)</span> is a vector of dimension
<span class="math inline">\(Q\)</span> for the <span class="math inline">\(Q\)</span> explanatory variables that will be
projected to reduce the rank,</li>
<li>
<span class="math inline">\(z\)</span> is a vector of dimension
<span class="math inline">\(R\)</span> for the <span class="math inline">\(R\)</span> explanatory variables that will not be
projected,</li>
<li>
<span class="math inline">\(\mu\)</span> is the constant vector of
dimension <span class="math inline">\(P\)</span>,</li>
<li>
<span class="math inline">\(innov\)</span> is the innovation vector
of dimension <span class="math inline">\(P\)</span>,</li>
<li>
<span class="math inline">\(D\)</span> is a coefficient matrix for
<span class="math inline">\(z\)</span> with dimension <span class="math inline">\(P*R\)</span>,</li>
<li>
<span class="math inline">\(A\)</span> is the so called exposure
matrix with dimension <span class="math inline">\(P*r\)</span>, and</li>
<li>
<span class="math inline">\(B\)</span> is the so called factor
matrix with dimension <span class="math inline">\(Q*r\)</span>.</li>
</ul>
<p>The matrix resulted from <span class="math inline">\(AB'\)</span>
will be a reduced rank coefficient matrix with rank of <span class="math inline">\(r\)</span>. The function estimates parameters
<span class="math inline">\(\mu\)</span>, <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(D\)</span>, and <span class="math inline">\(Sigma\)</span>, the covariance matrix of the
innovation’s distribution.</p>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>To simulate example data that can be used to estimate reduced-rank
regression, use function <code>RRR_sim</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RRR_sim.html">RRR_sim</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span></span>
<span><span class="co">#&gt; Simulated Data for Reduced-Rank Regression</span></span>
<span><span class="co">#&gt; ------------</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt;    N    P    Q    R    r </span></span>
<span><span class="co">#&gt; 1000    3    3    1    1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;         mu        A        B        D   Sigma1   Sigma2   Sigma3</span></span>
<span><span class="co">#&gt; 1  0.10000  1.08427  0.80637  0.61341  1.00000  0.00000  0.00000</span></span>
<span><span class="co">#&gt; 2  0.10000 -0.71361  0.22911 -0.34606  0.00000  1.00000  0.00000</span></span>
<span><span class="co">#&gt; 3  0.10000 -1.23433  0.27142  0.37301  0.00000  0.00000  1.00000</span></span></code></pre></div>
<p>A number of parameters can be specified. See <code><a href="../reference/RRR_sim.html">?RRR_sim</a></code>.
The default arguments are set in such a way that the matrix resulted
from <span class="math inline">\(AB'\)</span> will be a reduced rank
coefficient matrix with rank of <span class="math inline">\(r\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ spec:List of 11</span></span>
<span><span class="co">#&gt;   ..$ P    : num 3</span></span>
<span><span class="co">#&gt;   ..$ N    : num 1000</span></span>
<span><span class="co">#&gt;   ..$ Q    : num 3</span></span>
<span><span class="co">#&gt;   ..$ R    : num 1</span></span>
<span><span class="co">#&gt;   ..$ A    : num [1:3, 1] 1.084 -0.714 -1.234</span></span>
<span><span class="co">#&gt;   ..$ B    : num [1:3, 1] 0.806 0.229 0.271</span></span>
<span><span class="co">#&gt;   ..$ mu   : num [1:3] 0.1 0.1 0.1</span></span>
<span><span class="co">#&gt;   ..$ D    : num [1:3, 1] 0.613 -0.346 0.373</span></span>
<span><span class="co">#&gt;   ..$ r    : num 1</span></span>
<span><span class="co">#&gt;   ..$ Sigma: num [1:3, 1:3] 1 0 0 0 1 0 0 0 1</span></span>
<span><span class="co">#&gt;   ..$ innov: num [1:1000, 1:3] -0.261 0.207 0.971 0.571 -0.734 ...</span></span>
<span><span class="co">#&gt;  $ y   : num [1:1000, 1:3] -0.389 1.165 1.671 0.614 -1.585 ...</span></span>
<span><span class="co">#&gt;  $ x   : num [1:1000, 1:3] 0.4048 0.2184 1.2618 -0.7283 0.0706 ...</span></span>
<span><span class="co">#&gt;  $ z   : num [1:1000] -0.6855 0.4995 -0.3019 0.0231 -0.9905 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "RRR_data" "list"</span></span></code></pre></div>
<p>The returned list of <code>RRR_sim</code> contains the input
specifications and the data points <span class="math inline">\(y\)</span>, <span class="math inline">\(x\)</span>
and <span class="math inline">\(z\)</span>.</p>
</div>
<div class="section level2">
<h2 id="reduced-rank-regression-using-gaussian-mle-rrr">Reduced-Rank Regression using Gaussian MLE : <code>RRR</code><a class="anchor" aria-label="anchor" href="#reduced-rank-regression-using-gaussian-mle-rrr"></a>
</h2>
<p>The Gaussian Maximum Likelihood Estimation method is described in
Johansen, S. (<a href="#ref">1991</a>). This method is not robust in the
sense that it assumes a Gaussian distribution for the innovations which
does not take into account the heavy-tailedness of the true distribution
and outliers.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_gmle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RRR.html">RRR</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, z <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="va">res_gmle</span></span>
<span><span class="co">#&gt; Reduced-Rank Regression</span></span>
<span><span class="co">#&gt; ------------</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt;    N    P    Q    R    r </span></span>
<span><span class="co">#&gt; 1000    3    3    1    1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          mu         A         B         D    Sigma1    Sigma2    Sigma3</span></span>
<span><span class="co">#&gt; 1  0.012938  1.013672  0.942682  0.580991  3.345338 -0.299069 -3.038414</span></span>
<span><span class="co">#&gt; 2  0.148413 -0.588085  0.273039 -0.323479 -0.299069  3.372916  1.709844</span></span>
<span><span class="co">#&gt; 3  0.291647 -1.101053  0.330779  0.400010 -3.038414  1.709844 19.261569</span></span></code></pre></div>
<p>The matrix <span class="math inline">\(z\)</span> and the constant
<span class="math inline">\(\mu\)</span> term are optional.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_gmle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RRR.html">RRR</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, z<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">z</span>, mu <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">res_gmle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RRR.html">RRR</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, z<span class="op">=</span><span class="cn">NULL</span>, mu <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">res_gmle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RRR.html">RRR</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, z<span class="op">=</span><span class="cn">NULL</span>, mu <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="robust-reduced-rank-regression-using-cauchy-distribution-and-majorisation-minimisation-rrrr">Robust Reduced-Rank Regression using Cauchy distribution and
Majorisation-Minimisation: <code>RRRR</code><a class="anchor" aria-label="anchor" href="#robust-reduced-rank-regression-using-cauchy-distribution-and-majorisation-minimisation-rrrr"></a>
</h2>
<p>The Majorisation-Minimisation estimation method is partly described
in Zhao, Z., &amp; Palomar, D. P. (<a href="#ref">2017</a>). This method
is robust in the sense that it assumes a heavy-tailed Cauchy
distribution for the innovations. As before the matrix <span class="math inline">\(z\)</span> and the constant term <span class="math inline">\(\mu\)</span> are optional.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RRRR.html">RRRR</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, z <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">z</span>, </span>
<span>               itr <span class="op">=</span> <span class="fl">100</span>, </span>
<span>               earlystop <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span></span>
<span><span class="va">res_mm</span></span>
<span><span class="co">#&gt; Robust Reduced-Rank Regression</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; Majorisation-Minimisation</span></span>
<span><span class="co">#&gt; ------------</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt;    N    P    Q    R    r </span></span>
<span><span class="co">#&gt; 1000    3    3    1    1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          mu         A         B         D    Sigma1    Sigma2    Sigma3</span></span>
<span><span class="co">#&gt; 1  0.053612  0.445764  1.952775  0.576112  0.653569 -0.022268 -0.020604</span></span>
<span><span class="co">#&gt; 2  0.099420 -0.280023  0.552379 -0.322447 -0.022268  0.703277  0.014187</span></span>
<span><span class="co">#&gt; 3  0.099396 -0.507451  0.612118  0.361631 -0.020604  0.014187  0.692843</span></span></code></pre></div>
<p>Additional arguments that are worth noticing are <code>itr</code>,
which control the maximum number of iteration, and
<code>earlystop</code>, which is the criteria to stop the algorithm
early. The algorithm will stop if the improvement on objective value is
small than <code>earlystop</code> <span class="math inline">\(\times\
objective\_from\_last\_iteration\)</span>.</p>
<p>This method is an iterative optimization algorithm so we can use the
inbuilt <code>plot.RRRR</code> method to see the convergence plot of the
algorithm.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_mm</span>, aes_x <span class="op">=</span> <span class="st">"iteration"</span>, xlog10 <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="RRRR_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Argument <code>aes_x</code> can set the x axis to be the number of
iteration or the run time. Argument <code>xlog10</code> can indicate
whether the scale of x axis is log 10 transformed.</p>
</div>
<div class="section level2">
<h2 id="online-robust-reduced-rank-regression-orrrr">Online Robust Reduced-Rank Regression: <code>ORRRR</code><a class="anchor" aria-label="anchor" href="#online-robust-reduced-rank-regression-orrrr"></a>
</h2>
<p>The description of the generic Stochastic Successive Upper-bound
Minimisation method and the Sample Average Approximation can be found in
Razaviyayn, M., Sanjabi, M., &amp; Luo, Z. Q. (<a href="#ref">2016</a>).</p>
<p>There are two major estimation methods supported:</p>
<ul>
<li>SMM: Stochastic Majorisation-Minimisation</li>
<li>SAA: Sample Average Approximation</li>
</ul>
<p>The algorithm is online in the sense that the data is continuously
incorporated and the algorithm can update the parameters accordingly. As
before the matrix <span class="math inline">\(z\)</span> and the
constant term <span class="math inline">\(\mu\)</span> are optional.</p>
<p>At each iteration of SAA, a new realisation of the parameters is
achieved by solving the minimisation problem of the sample average of
the desired objective function using the data currently incorporated.
This can be computationally expensive when the objective function is
highly nonconvex. The SMM method overcomes this difficulty by replacing
the objective function by a well-chosen majorising surrogate function
which can be much easier to optimise.</p>
<div class="section level3">
<h3 id="smm-stochastic-majorisation-minimisation">SMM: Stochastic Majorisation-Minimisation<a class="anchor" aria-label="anchor" href="#smm-stochastic-majorisation-minimisation"></a>
</h3>
<p>By default the function <code>ORRRR</code> uses SMM.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_smm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ORRRR.html">ORRRR</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, z<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">z</span>, </span>
<span>                 initial_size <span class="op">=</span> <span class="fl">100</span>, addon <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: lazybar</span></span>
<span><span class="va">res_smm</span></span>
<span><span class="co">#&gt; Online Robust Reduced-Rank Regression</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; Stochastic Majorisation-Minimisation</span></span>
<span><span class="co">#&gt; ------------</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt;            N            P            R            r initial_size        addon </span></span>
<span><span class="co">#&gt;         1000            3            1            1          100           10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          mu         A         B         D    Sigma1    Sigma2    Sigma3</span></span>
<span><span class="co">#&gt; 1  0.054144  0.449807  1.937679  0.575796  0.671604 -0.023718 -0.020262</span></span>
<span><span class="co">#&gt; 2  0.102738 -0.283247  0.544009 -0.323879 -0.023718  0.721810  0.012375</span></span>
<span><span class="co">#&gt; 3  0.100835 -0.509571  0.608201  0.360788 -0.020262  0.012375  0.707851</span></span></code></pre></div>
<p>The simulated data set is of size 1000. In the above command, in the
first iteration 100 realisations are used in the estimation with 10 more
data points in each of the following iteration. Because of the
increasing data size, the estimation will be slower the longer the
algorithm run. Therefore, the estimated time left in the progress bar is
not very accurate in this sense.</p>
<p>The output from <code>ORRRR</code> can also plotted using
<code>plot.RRRR</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_smm</span><span class="op">)</span></span></code></pre></div>
<p><img src="RRRR_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="saa-sample-average-approximation">SAA: Sample Average Approximation<a class="anchor" aria-label="anchor" href="#saa-sample-average-approximation"></a>
</h3>
<p>When using SAA, there are two sub solver supported in each
iteration.</p>
<ul>
<li>optim: the <code>optim</code> function from the <code>stats</code>
package, and</li>
<li>MM: Majorisation-Minimisation method with ten subiterations by
default.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_saa_optim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ORRRR.html">ORRRR</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, z<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">z</span>,</span>
<span>                       method <span class="op">=</span> <span class="st">"SAA"</span>, SAAmethod <span class="op">=</span> <span class="st">"optim"</span><span class="op">)</span></span>
<span><span class="va">res_saa_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ORRRR.html">ORRRR</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, z<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">z</span>,</span>
<span>                       method <span class="op">=</span> <span class="st">"SAA"</span>, SAAmethod <span class="op">=</span> <span class="st">"MM"</span><span class="op">)</span></span></code></pre></div>
<p><code>optim</code> is a general purpose solver which means it will be
quite slow for this specific problem, especially when the number of
parameters is large. Embedding majorisation-minimisation into
subiteration of SAA is more like a heuristic without solid theory
backing up its efficiency. Due to the time constraint we do not show the
estimated result here.</p>
</div>
</div>
<div class="section level2">
<h2 id="truly-online-update-rrrr">Truly online: <code>update.RRRR</code><a class="anchor" aria-label="anchor" href="#truly-online-update-rrrr"></a>
</h2>
<p>With the result from <code>ORRRR</code>, user can still update it
with newly achieved data using function <code>update</code>. Note the
result from <code>RRRR</code> can also be updated where it simply takes
the result from <code>RRRR</code> as the starting point in online
estimation.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RRR_sim.html">RRR_sim</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res2_smm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">res_smm</span>, newy<span class="op">=</span><span class="va">newdata</span><span class="op">$</span><span class="va">y</span>, newx<span class="op">=</span><span class="va">newdata</span><span class="op">$</span><span class="va">x</span>, newz<span class="op">=</span><span class="va">newdata</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="va">res2_smm</span></span>
<span><span class="co">#&gt; Online Robust Reduced-Rank Regression</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; Stochastic Majorisation-Minimisation</span></span>
<span><span class="co">#&gt; ------------</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt;            N            P            R            r initial_size        addon </span></span>
<span><span class="co">#&gt;         2000            3            1            1         1010           10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          mu         A         B         D    Sigma1    Sigma2    Sigma3</span></span>
<span><span class="co">#&gt; 1  0.174109 -0.180878  1.928014  0.486495  1.786481 -0.843835 -0.102663</span></span>
<span><span class="co">#&gt; 2  0.079571  0.200884 -0.429651 -0.075581 -0.843835  1.419247  0.132694</span></span>
<span><span class="co">#&gt; 3  0.104804 -0.314889  1.254126  0.441822 -0.102663  0.132694  0.873581</span></span></code></pre></div>
<p>Without other arguments specified, <code>update</code> will just take
the original specification in the model. If it applies to output of
<code>RRRR</code>, then the default would be the default arguments in
<code>ORRRR</code>, i.e., with <code>method</code> set to “SMM” and
<code>addon</code> set to 10.</p>
</div>
<div class="section level2">
<h2 id="ref">References<a class="anchor" aria-label="anchor" href="#ref"></a>
</h2>
<p><a href="https://www.jstor.org/stable/2938278?origin=crossref" class="external-link">Johansen,
S{}ren. 1991. “Estimation and Hypothesis Testing of Cointegration
Vectors in Gaussian Vector Autoregressive Models.” Econometrica: Journal
of the Econometric Society 59 (6): 1551.</a></p>
<p><a href="https://ieeexplore.ieee.org/abstract/document/8309093/" class="external-link">Z.
Zhao and D. P. Palomar, “Robust maximum likelihood estimation of sparse
vector error correction model,” in2017 IEEE Global Conferenceon Signal
and Information Processing (GlobalSIP), pp. 913–917,IEEE, 2017.</a></p>
<p><a href="https://link.springer.com/article/10.1007/s10107-016-1021-7" class="external-link">Razaviyayn,
Meisam, Maziar Sanjabi, and Zhi Quan Luo. 2016. “A Stochastic Successive
Minimization Method for Nonsmooth Nonconvex Optimization with
Applications to Transceiver Design in Wireless Communication Networks.”
Mathematical Programming. A Publication of the Mathematical Programming
Society 157 (2): 515–45.</a></p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This package is free and open source software, licensed under
GPL-3</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Yangzhuoran Fin Yang, <a href="https://zipingzhao.github.io/" class="external-link">Ziping Zhao</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
